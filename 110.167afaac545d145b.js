"use strict";(self.webpackChunkrazvivator=self.webpackChunkrazvivator||[]).push([[110],{6110:(ae,C,s)=>{s.r(C),s.d(C,{SortItemsConfigModule:()=>me});var f=s(9808),Y=s(933),G=s(2747),T=s(5562),e=s(5e3);let N=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[f.ez,T.P,Y.q,G.U]]}),r})();var a,p,z=s(4106),Z=s(395),H=s(8450),x=s(4636),n=s(655),B=s(5713),u=s(3753),S=s(4850),P=s(7545),J=s(7625),X=s(2986),L=s(2868),l=s(2188),y=s(7866),d=s(1834);class v{constructor(i,t,o){this._elementRef=i,this._renderer=t,this._document=o,this.dragArea=null,this.propsToRestore=[],this.elFromPoint=new e.vpe,a.set(this,null),p.set(this,{})}ngAfterViewInit(){(0,n.YH)(this,a,this._elementRef.nativeElement,"f");const i=(0,u.R)((0,n.Q_)(this,a,"f"),y.m.MOUSEDOWN),t=(0,u.R)(this.dragArea,y.m.MOUSEMOVE),o=(0,u.R)(this.dragArea,y.m.MOUSEUP);i.pipe((0,S.U)(m=>{m.preventDefault(),this._renderer.setStyle(this.dragArea,l.L.POSITION,"relative"),this.propsToRestore.forEach(M=>(0,n.Q_)(this,p,"f")[M]=(0,n.Q_)(this,a,"f").style[M]);const c=(0,n.Q_)(this,a,"f").getBoundingClientRect(),h=this.dragArea.getBoundingClientRect();this._renderer.setStyle((0,n.Q_)(this,a,"f"),l.L.WIDTH,`${c.width}${d.N.PX}`),this._renderer.setStyle((0,n.Q_)(this,a,"f"),l.L.HEIGHT,`${c.height}${d.N.PX}`),this._renderer.setStyle((0,n.Q_)(this,a,"f"),l.L.POSITION,"absolute"),this._renderer.setStyle((0,n.Q_)(this,a,"f"),l.L.Z_INDEX,100);const A=m.clientX-c.left+h.left,E=m.clientY-c.top+h.top;return this._renderer.setStyle((0,n.Q_)(this,a,"f"),l.L.LEFT,`${m.pageX-A}${d.N.PX}`),this._renderer.setStyle((0,n.Q_)(this,a,"f"),l.L.TOP,`${m.pageY-E}${d.N.PX}`),{x:A,y:E}}),(0,P.w)(m=>t.pipe((0,S.U)(c=>{c.preventDefault(),this._renderer.setStyle((0,n.Q_)(this,a,"f"),l.L.LEFT,`${c.pageX-m.x}${d.N.PX}`),this._renderer.setStyle((0,n.Q_)(this,a,"f"),l.L.TOP,`${c.pageY-m.y}${d.N.PX}`)}),(0,J.R)(o),(0,P.w)(()=>o.pipe((0,X.q)(1),(0,L.b)(c=>{const h=(0,n.Q_)(this,a,"f").style.display;this._renderer.setStyle((0,n.Q_)(this,a,"f"),l.L.DISPLAY,"none"),this.elFromPoint.emit(this._document.elementFromPoint(c.clientX,c.clientY)),this._renderer.setStyle((0,n.Q_)(this,a,"f"),l.L.DISPLAY,h)})))))).subscribe()}backEl(){this._renderer.removeStyle((0,n.Q_)(this,a,"f"),l.L.POSITION),this._renderer.removeStyle((0,n.Q_)(this,a,"f"),l.L.TOP),this._renderer.removeStyle((0,n.Q_)(this,a,"f"),l.L.LEFT);for(const[i,t]of Object.entries((0,n.Q_)(this,p,"f")))this._renderer.setStyle((0,n.Q_)(this,a,"f"),i,t)}destroyEl(){(0,n.Q_)(this,a,"f").remove()}}a=new WeakMap,p=new WeakMap,v.\u0275fac=function(i){return new(i||v)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(f.K0))},v.\u0275dir=e.lG2({type:v,selectors:[["","drag",""]],inputs:{dragArea:"dragArea",propsToRestore:"propsToRestore"},outputs:{elFromPoint:"elFromPoint"}});var F=s(1995),Q=s(5605),D=s(9417),O=s(2281),U=s(1340),R=s(8397),j=s(520);class g{constructor(i){this._http=i}getCoords(){const i=`${R.J.getCustomGameThemeFolder()}coords.${F.D.JSON}`;return this._fetchCoords(i)}_fetchCoords(i){return this._http.get(i)}}g.\u0275fac=function(i){return new(i||g)(e.LFG(j.eN))},g.\u0275prov=e.Yz7({token:g,factory:g.\u0275fac}),(0,n.gn)([(0,U.q)()],g.prototype,"_fetchCoords",null);var W=s(6849),V=s(567),I=s(1709),K=s(4002),$=s(864),w=s(9146),b=s(613),k=s(4853),q=s(9254),_=s(8889),ee=s(4729);let te=(()=>{class r extends _.l{constructor(t,o,m,c){super(m,c),this._elementRef=t,this._renderer=o}setGameSizes(){const t=Math.min(400,ee.B.getMinDimension()/2-20);this._renderer.setStyle(this._elementRef.nativeElement,l.L.WIDTH,`${t}${d.N.PX}`),this._renderer.setStyle(this._elementRef.nativeElement,l.L.HEIGHT,`${1.25*t}${d.N.PX}`)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(e.R0b),e.Y36(f.K0))},r.\u0275dir=e.lG2({type:r,selectors:[["","areaBgSizer",""]],features:[e.qOj]}),r})();function se(r,i){if(1&r&&e._UZ(0,"img",10),2&r){const t=i.$implicit,o=i.index,m=e.oxw().$implicit;e.Q6J("src",t.img,e.LSH)("ngStyle",m.coords[o].style)}}function re(r,i){if(1&r&&(e.TgZ(0,"div",7),e._UZ(1,"img",8),e.YNc(2,se,1,2,"img",9),e.qZA()),2&r){const t=i.$implicit;e.xp6(1),e.s9C("id",t.id),e.Q6J("src",t.img,e.LSH),e.xp6(1),e.Q6J("ngForOf",t.items)}}const ie=function(r,i){return[r,i]};function oe(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"figure",11),e.TgZ(1,"img",12),e.NdJ("elFromPoint",function(m){const h=e.CHM(t).index;return e.oxw().checkItem(m,h)}),e.qZA(),e.qZA()}if(2&r){const t=i.$implicit,o=e.oxw(),m=e.MAs(2);e.xp6(1),e.Q6J("src",t.img,e.LSH)("dragArea",m)("propsToRestore",e.WLB(3,ie,o.styleProps.WIDTH,o.styleProps.HEIGHT))}}let ne=(()=>{class r{constructor(t,o){this._themeItemsService=t,this._sortItemsService=o,this.gameLoader=null,this.items=null,this.idLeft="",this.areas=null,this.styleProps=l.L,this.itemsAmount=B.k.getAgesConfig()}ngOnInit(){this._buildGame()}_buildGame(){this.gameLoader=(0,V.D)({items:this._themeItemsService.getItems(),coords:this._sortItemsService.getCoords()}).pipe((0,I.zg)(t=>(this.areas=Object.keys(t.coords).map(o=>({id:o,img:`${R.J.getCustomGameThemeFolder()}${o}.${F.D.SVG}`,items:[],coords:t.coords[o].map(m=>new b.m(m))})),t.items)),(0,K.v)(t=>t.theme.id),(0,I.zg)(t=>t.pipe((0,$.q)(),(0,S.U)(o=>Q.$.getRandItems(o,this.itemsAmount)))),(0,w.J)(),(0,$.q)(),(0,L.b)(t=>this.items=Q.$.shuffle(t)),(0,I.zg)(()=>O.r.preloadThemeItemsImgs([].concat(this.items,this.areas))))}checkItem(t,o){return(0,n.mG)(this,void 0,void 0,function*(){const m=this.dragD.toArray()[o];this.items[o].theme.id===t.getAttribute("id")?(this.areas.find(h=>h.id===t.getAttribute("id")).items.push(this.items[o]),m.destroyEl(),yield D.d.playRightSound(),this.areas.every(h=>h.items.length===this.items.length/2)&&W.A.gameCompleted()):(m.backEl(),yield D.d.playErrorSound())})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(O.r),e.Y36(g))},r.\u0275cmp=e.Xpm({type:r,selectors:[["sort-items"]],viewQuery:function(t,o){if(1&t&&e.Gf(v,5),2&t){let m;e.iGM(m=e.CRH())&&(o.dragD=m)}},features:[e._Bn([g])],decls:7,vars:4,consts:[[3,"gameLoader"],[1,"container"],["container",""],[1,"text--center"],["class","area","areaBgSizer","",4,"ngFor","ngForOf"],["gridSizer","","itemSize","100","rowsAmount","2",3,"columnsAmount"],["class","figure",4,"ngFor","ngForOf"],["areaBgSizer","",1,"area"],[1,"area__bg",3,"id","src"],["class","area__item",3,"src","ngStyle",4,"ngFor","ngForOf"],[1,"area__item",3,"src","ngStyle"],[1,"figure"],["drag","",1,"figure__img","cursor--pointer",3,"src","dragArea","propsToRestore","elFromPoint"]],template:function(t,o){1&t&&(e.TgZ(0,"game-spinner-wrapper",0),e.TgZ(1,"div",1,2),e.TgZ(3,"div",3),e.YNc(4,re,3,3,"div",4),e.qZA(),e.TgZ(5,"div",5),e.YNc(6,oe,2,6,"figure",6),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.Q6J("gameLoader",o.gameLoader),e.xp6(4),e.Q6J("ngForOf",o.areas),e.xp6(1),e.s9C("columnsAmount",o.itemsAmount),e.xp6(1),e.Q6J("ngForOf",o.items))},directives:[k.Z,f.sg,q.d,te,f.PC,v],styles:[".figure[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%}.figure__img[_ngcontent-%COMP%]{max-width:80%;max-height:80%}.container[_ngcontent-%COMP%]{height:100%;display:grid;grid-template-rows:1fr -webkit-min-content;grid-template-rows:1fr min-content;place-items:center}.area[_ngcontent-%COMP%]{display:inline-block;position:relative}.area__bg[_ngcontent-%COMP%]{width:100%;position:absolute;top:0;left:0}.area__item[_ngcontent-%COMP%]{max-width:18%;position:absolute}"],changeDetection:0}),r})(),me=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[f.ez,z.f.forChild({agesConfig:new Map([[0,4],[1,6],[2,8]])}),T.P.forChild(),N,Z.GameStepsModule.forChild([H.N,x.Z,ne])]]}),r})()}}]);