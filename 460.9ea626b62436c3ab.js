"use strict";(self.webpackChunkrazvivator=self.webpackChunkrazvivator||[]).push([[460],{2460:(x,C,t)=>{t.r(C),t.d(C,{ColorizeFromMemoryConfigModule:()=>ee});var m=t(9808),a=t(4106),f=t(8450),A=t(395),v=t(4636),d=t(5562),h=t(2747),_=t(933),i=t(655),p=t(5713),T=t(1340),S=t(4729),I=t(8397),F=t(1995),B=t(534),D=t(2198),l=t(373),u=t(864),n=t(9082),e=t(5e3),M=t(520);class g extends n.S{constructor(r){super(),this._http=r,this.chosenSetIndex=null}getAddItems(){const r=`${S.B.getGameFolder()}themes/${I.J.getChosenTheme().id}.${F.D.JSON}`;return this._fetchPictures(r).pipe((0,B.u)(),(0,D.h)(o=>p.k.getAgeId()>=o.minAgeId),(0,l.j)("paths"),(0,u.q)())}_fetchPictures(r){return this._http.get(r)}}g.\u0275fac=function(r){return new(r||g)(e.LFG(M.eN))},g.\u0275prov=e.Yz7({token:g,factory:g.\u0275fac}),(0,i.gn)([(0,T.q)()],g.prototype,"_fetchPictures",null);let P=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[g],imports:[[m.ez,_.q,h.U]]}),s})();var y=t(9771),L=t(6849),G=t(4850),N=t(2868),$=t(4853),Z=t(2313);let U=(()=>{class s{constructor(o){this._sanitizer=o,this.cursor=null}ngOnChanges(){this.cursor=this._getBrush()}_getBrush(){const c=`"data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='40px' height='40px' viewBox='0 0 40 40' enable-background='new 0 0 40 40' xml:space='preserve'%3E%3Cpath fill='%23${this.color.substring(1)}' stroke='%23383838' stroke-miterlimit='10' d='M9.662,13.208c1.955-1.163,3.54-3.893,2.158-6.067C10.304,4.758,6.036,6.84,4.871,4.544C4.358,3.535,5.509,2.26,4.998,1.25c-1.69,1.492-3.306,3.017-3.476,5.39C1.184,11.355,4.763,16.12,9.662,13.208z'/%3E%3Cpath fill='%23383838' stroke='%23383838' stroke-miterlimit='10' d='M19.665,28.435c-7.157-6.254-11.103-13.492-9.453-15.38s8.79,1.65,15.947,7.903s14.243,14.911,12.592,16.799S26.822,34.689,19.665,28.435z'/%3E%3C/svg%3E"`;return this._sanitizer.bypassSecurityTrustStyle(`url(${c}), pointer`)}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(Z.H7))},s.\u0275dir=e.lG2({type:s,selectors:[["","cursorBrush",""]],hostVars:2,hostBindings:function(o,c){2&o&&e.Udp("cursor",c.cursor)},inputs:{color:["cursorBrush","color"]},features:[e.TTD]}),s})();var O,J=t(8632),Y=t(9254),w=t(9186);function H(s,r){if(1&s){const o=e.EpF();e.TgZ(0,"progress-bar",7),e.NdJ("timeIsOver",function(){return e.CHM(o),e.oxw().discolorPicture()}),e.qZA()}if(2&s){const o=e.oxw();e.Q6J("time",o.time)}}function W(s,r){if(1&s){const o=e.EpF();e.O4$(),e.TgZ(0,"path",8),e.NdJ("click",function(E){const R=e.CHM(o).$implicit;return e.oxw().applyColor(E,R)}),e.qZA()}if(2&s){const o=r.$implicit,c=e.oxw();e.uIk("d",o.d)("fill",o.fill)("stroke",c.strokeColor)}}function K(s,r){if(1&s){const o=e.EpF();e.TgZ(0,"blot",11),e.NdJ("click",function(E){const R=e.CHM(o).$implicit;return e.oxw(2).selectColor(E,R)}),e.qZA()}2&s&&e.Q6J("fill",r.$implicit)}function Q(s,r){if(1&s&&(e.O4$(),e.kcU(),e.TgZ(0,"div",9),e.YNc(1,K,1,1,"blot",10),e.qZA()),2&s){const o=e.oxw();e.s9C("columnsAmount",null==o.blotsColors?null:o.blotsColors.length),e.xp6(1),e.Q6J("ngForOf",o.blotsColors)}}class z{constructor(r,o,c){this._cdRef=r,this._colorizeFromMemoryService=o,this._addStepService=c,this.gameLoader=null,this.gameLoaded=!1,this.picture=null,this.blotsColors=null,this.time=0,this.showBlotsBar=!1,this.selectedColor=y.r.WHITE,this.strokeColor=y.r.BLACK,O.set(this,null)}ngOnInit(){this._buildGame()}discolorPicture(){this.picture.forEach(r=>!r.static&&(r.fill=y.r.WHITE)),this.showBlotsBar=!0,this._cdRef.detectChanges()}selectColor(r,o){!this.showBlotsBar||(r.stopPropagation(),this.selectedColor=o,this._cdRef.detectChanges())}applyColor(r,o){!this.showBlotsBar||o.static||(r.stopPropagation(),o.fill=this.selectedColor,this._check())}_buildGame(){this.gameLoader=this._colorizeFromMemoryService.getAddItems().pipe((0,G.U)(r=>r[this._addStepService.chosenSetIndex]),(0,N.b)(r=>{(0,i.YH)(this,O,r.map(o=>Object.assign({},o)),"f"),this.picture=r.map(o=>Object.assign({},o)),this.blotsColors=(0,i.Q_)(this,O,"f").reduce((o,c)=>(c.static||c.fill===y.r.WHITE||o.some(E=>E===c.fill)||o.push(c.fill),o),[]),this.time=p.k.getAgesConfig()}))}_check(){for(let r=0;r<(0,i.Q_)(this,O,"f").length;r++)if((0,i.Q_)(this,O,"f")[r].fill!==this.picture[r].fill)return;L.A.gameCompleted()}}O=new WeakMap,z.\u0275fac=function(r){return new(r||z)(e.Y36(e.sBO),e.Y36(g),e.Y36(n.S))},z.\u0275cmp=e.Xpm({type:z,selectors:[["colorize-from-memory"]],decls:7,vars:6,consts:[[3,"gameLoader","loadGame"],[1,"container","h--100"],[3,"time","timeIsOver",4,"ngIf"],[1,"brush-area","h--100","overflow--hidden",3,"cursorBrush"],[1,"h-max--100","m--auto"],["stroke-width","2",3,"click",4,"ngFor","ngForOf"],["gridSizer","","itemSize","100","rowsAmount","1",3,"columnsAmount",4,"ngIf"],[3,"time","timeIsOver"],["stroke-width","2",3,"click"],["gridSizer","","itemSize","100","rowsAmount","1",3,"columnsAmount"],[3,"fill","click",4,"ngFor","ngForOf"],[3,"fill","click"]],template:function(r,o){1&r&&(e.TgZ(0,"game-spinner-wrapper",0),e.NdJ("loadGame",function(){return o.gameLoaded=!0}),e.TgZ(1,"div",1),e.YNc(2,H,1,1,"progress-bar",2),e.TgZ(3,"div",3),e.O4$(),e.TgZ(4,"svg",4),e.YNc(5,W,1,3,"path",5),e.qZA(),e.YNc(6,Q,2,2,"div",6),e.qZA(),e.qZA(),e.qZA()),2&r&&(e.Q6J("gameLoader",o.gameLoader),e.xp6(2),e.Q6J("ngIf",o.gameLoaded),e.xp6(1),e.Q6J("cursorBrush",o.selectedColor),e.xp6(1),e.uIk("viewBox","0 0 400 400"),e.xp6(1),e.Q6J("ngForOf",o.picture),e.xp6(1),e.Q6J("ngIf",o.showBlotsBar))},directives:[$.Z,m.O5,U,m.sg,J.R,Y.d,w.k],styles:[".container[_ngcontent-%COMP%]{display:grid;grid-template-rows:-webkit-min-content 1fr -webkit-min-content;grid-template-rows:min-content 1fr min-content}.brush-area[_ngcontent-%COMP%]{display:grid;grid-template-rows:1fr -webkit-min-content;grid-template-rows:1fr min-content}"],changeDetection:0});var j=t(5059);function b(s,r){if(1&s&&(e.O4$(),e._UZ(0,"path",4)),2&s){const o=r.$implicit,c=e.oxw(2);e.uIk("d",o.d)("fill",c.colors.WHITE)("stroke",c.colors.BLACK)}}function X(s,r){if(1&s&&(e.O4$(),e.TgZ(0,"svg",2),e.YNc(1,b,1,3,"path",3),e.qZA()),2&s){const o=r.$implicit;e.uIk("viewBox","0 0 400 400"),e.xp6(1),e.Q6J("ngForOf",o)}}let V=(()=>{class s{constructor(){this.colors=y.r}}return s.\u0275fac=function(o){return new(o||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["picture-choice"]],decls:3,vars:1,consts:[[3,"customSetTmpl"],["pictureTmpl",""],[1,"cursor--pointer"],["stroke-width","1",4,"ngFor","ngForOf"],["stroke-width","1"]],template:function(o,c){if(1&o&&(e._UZ(0,"pictures-choice",0),e.YNc(1,X,2,2,"ng-template",null,1,e.W1O)),2&o){const E=e.MAs(2);e.Q6J("customSetTmpl",E)}},directives:[j.g,m.sg],encapsulation:2,changeDetection:0}),s})();var k=t(1233),q=t(8035);let ee=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[m.ez,k.D,a.f.forChild({agesConfig:new Map([[0,12],[1,10],[2,8]]),stepsToReset:[1,2,3]}),d.P.forChild({ageDependency:!0}),q.P.forChild({addStepService:g}),P,A.GameStepsModule.forChild([f.N,v.Z,V,z])]]}),s})()},4106:(x,C,t)=>{t.d(C,{f:()=>d});var m=t(9808),a=t(933),f=t(6007),A=t(1233),v=t(5e3);let d=(()=>{class h{static forChild(i){return{ngModule:h,providers:[{provide:f.n,useValue:i.agesConfig},{provide:f.O,useValue:i.stepsToReset}]}}}return h.\u0275fac=function(i){return new(i||h)},h.\u0275mod=v.oAB({type:h}),h.\u0275inj=v.cJS({imports:[[m.ez,A.D,a.q]]}),h})()},8450:(x,C,t)=>{t.d(C,{N:()=>D});var m=t(6849),a=t(9771);const f={0:a.r.PINK,1:a.r.ORANGE,2:a.r.GREEN},A={0:"3 - 4",1:"4 - 5",2:"5 - 6"};class v{constructor(u,n){this.id=u;const e=A[this.id];this.title=`${e} ${n[e]}`,this.color=f[this.id]}}var d=t(5713),h=t(6007),_=t(4850),i=t(5e3),p=t(2273),T=t(9808);let S=(()=>{class l{static _getStyleProp(n){return`style.${n}`}ngOnInit(){this._setDefaultColors()}onMouseEnter(){this.color=this.borderColor=a.r.WHITE,this.bgColor=this.age.color,this.boxShadow=`0 0 16px 3px ${a.r.LIGHT_GREY}`}onMouseLeave(){this._setDefaultColors()}_setDefaultColors(){this.color=this.borderColor=this.age.color,this.bgColor=a.r.WHITE,this.boxShadow="none"}}return l.\u0275fac=function(n){return new(n||l)},l.\u0275dir=i.lG2({type:l,selectors:[["","ageItemColorize",""]],hostVars:8,hostBindings:function(n,e){1&n&&i.NdJ("mouseenter",function(){return e.onMouseEnter()})("mouseleave",function(){return e.onMouseLeave()}),2&n&&i.Udp("color",e.color)("border-color",e.borderColor)("background-color",e.bgColor)("box-shadow",e.boxShadow)},inputs:{age:["ageItemColorize","age"]}}),l})();var I=t(829);function F(l,u){if(1&l){const n=i.EpF();i.TgZ(0,"div",4),i.NdJ("click",function(){const g=i.CHM(n).$implicit;return i.oxw(2).chooseAge(g)}),i._uU(1),i.qZA()}if(2&l){const n=u.$implicit;i.Q6J("ageItemColorize",n),i.xp6(1),i.hij(" ",n.title," ")}}function B(l,u){if(1&l&&(i.TgZ(0,"div",1),i.TgZ(1,"div",2),i._uU(2),i.ALo(3,"capitalizeFirstLetter"),i.qZA(),i.YNc(4,F,2,2,"div",3),i.qZA()),2&l){const n=u.ngIf;i.xp6(2),i.hij("",i.lcZ(3,2,n.title),"?"),i.xp6(2),i.Q6J("ngForOf",n.ages)}}let D=(()=>{class l{constructor(n,e,M){this._agesConfig=n,this._stepsToReset=e,this._translationsService=M,this.content$=this._translationsService.loadTranslation("ages").pipe((0,_.U)(g=>({title:g.title,ages:Array.from(this._agesConfig.keys()).map(P=>new v(P,g))})))}ngOnInit(){d.k.setAgesConfig(this._agesConfig),this._stepsToReset&&m.A.resetSteps(this._stepsToReset)}chooseAge(n){d.k.setAgeId(n.id),m.A.updateStepInfo({title:n.title,style:{color:n.color}}),m.A.goToNext()}}return l.\u0275fac=function(n){return new(n||l)(i.Y36(h.n),i.Y36(h.O),i.Y36(p.f))},l.\u0275cmp=i.Xpm({type:l,selectors:[["age-choice"]],decls:2,vars:3,consts:[["class","ages-choice",4,"ngIf"],[1,"ages-choice"],[1,"ages-choice__title"],["class","ages-choice__age",3,"ageItemColorize","click",4,"ngFor","ngForOf"],[1,"ages-choice__age",3,"ageItemColorize","click"]],template:function(n,e){1&n&&(i.YNc(0,B,5,4,"div",0),i.ALo(1,"async")),2&n&&i.Q6J("ngIf",i.lcZ(1,1,e.content$))},directives:[T.O5,T.sg,S],pipes:[T.Ov,I.G],styles:[".ages-choice__title[_ngcontent-%COMP%]{margin-bottom:2rem;text-align:center;font-size:3rem;color:#70b}.ages-choice__age[_ngcontent-%COMP%]{width:100%;max-width:500px;margin:2rem auto;padding:.5rem;text-align:center;font-size:2rem;font-weight:bolder;border:2px solid;border-radius:50%;cursor:pointer}"],changeDetection:0}),l})()},6007:(x,C,t)=>{t.d(C,{n:()=>a,O:()=>f});var m=t(5e3);const a=new m.OlP("AGES_CONFIG_TOKEN"),f=new m.OlP("STEPS_TO_RESET_TOKEN")},9254:(x,C,t)=>{t.d(C,{d:()=>h});var m=t(9808),a=t(2188),f=t(4729),A=t(8889),v=t(1834),d=t(5e3);let h=(()=>{class _ extends A.l{constructor(p,T,S,I){super(S,I),this._elementRef=p,this._renderer=T,this.rowsAmount=1,this.columnsAmount=1,this.itemSize=300,this.coeff=1}ngOnInit(){super.ngOnInit(),this._renderer.setStyle(this._elementRef.nativeElement,a.L.DISPLAY,"grid"),this._renderer.setStyle(this._elementRef.nativeElement,a.L.GRID_GAP,`0.5${v.N.REM}`),this._renderer.setStyle(this._elementRef.nativeElement,a.L.JUSTIFY_CONTENT,"center")}setGameSizes(){const p=Math.min(this.itemSize,f.B.getGridContainerMinDimension()/Math.max(this.rowsAmount,this.columnsAmount)-12);this._renderer.setStyle(this._elementRef.nativeElement,a.L.GRID_TEMPLATE_COLUMNS,`repeat(${this.columnsAmount}, ${p}${v.N.PX})`),this._renderer.setStyle(this._elementRef.nativeElement,a.L.GRID_TEMPLATE_ROWS,`repeat(${this.rowsAmount}, ${p*this.coeff}${v.N.PX})`)}}return _.\u0275fac=function(p){return new(p||_)(d.Y36(d.SBq),d.Y36(d.Qsj),d.Y36(d.R0b),d.Y36(m.K0))},_.\u0275dir=d.lG2({type:_,selectors:[["","gridSizer",""]],inputs:{rowsAmount:"rowsAmount",columnsAmount:"columnsAmount",itemSize:"itemSize",coeff:"coeff"},features:[d.qOj]}),_})()}}]);