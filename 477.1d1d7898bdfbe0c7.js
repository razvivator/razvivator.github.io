"use strict";(self.webpackChunkrazvivator=self.webpackChunkrazvivator||[]).push([[477],{477:(se,S,i)=>{i.r(S),i.d(S,{GameStepsComponent:()=>u});var a=i(655),c=i(6895),e=i(4650),F=i(1739),x=i(9771),v=i(4729),_=i(9417),M=i(7579),g=i(8505),f=i(2722),Q=i(6871),d=i(6849),Z=i(8397);let B=(()=>{class t{constructor(o){this._location=o}closeGame(){this._location.back(),Z.J.unsetTheme()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(c.Ye))},t.\u0275cmp=e.Xpm({type:t,selectors:[["close-game"]],standalone:!0,features:[e._Bn([c.Ye,{provide:c.S$,useClass:c.b0}]),e.jDz],decls:1,vars:0,consts:[[1,"cross","smooth-bg",3,"click"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return s.closeGame()}),e.qZA())},styles:['.cross[_ngcontent-%COMP%]{width:50px;height:50px;position:relative;cursor:pointer}.cross[_ngcontent-%COMP%]:before{content:"";width:100%;height:20%;background-color:#ff2480;position:absolute;top:20px;transform:rotate(45deg)}.cross[_ngcontent-%COMP%]:after{content:"";width:100%;height:20%;background-color:#ff2480;position:absolute;top:20px;transform:rotate(-45deg)}'],changeDetection:0}),t})();var T=i(5861),A=i(7926),I=i(4128),P=i(4004),Y=i(2273);let y=(()=>{class t{constructor(o){this._translationsService=o,this.message$=null,this.colors=x.r}ngOnInit(){this.message$=(0,I.D)({img:A.O.getImage(this.imgSrc),translation:this._translationsService.loadTranslation("game_finished")}).pipe((0,P.U)(o=>(this.playSound(),o.translation[this.translationProp])))}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(Y.f))},t.\u0275dir=e.lG2({type:t}),t})();var k=i(1995),G=i(829);function J(t,n){if(1&t&&(e.TgZ(0,"div",1),e._UZ(1,"img",2),e.TgZ(2,"div",3),e._uU(3),e.ALo(4,"capitalizeFirstLetter"),e.qZA()()),2&t){const o=n.ngIf,s=e.oxw();e.xp6(1),e.Q6J("src",s.imgSrc,e.LSH),e.xp6(1),e.Udp("color",s.colors.ORANGE),e.xp6(1),e.hij(" ",e.lcZ(4,4,o)," ")}}let N=(()=>{class t extends y{constructor(){super(...arguments),this.imgSrc=`../../../../../assets/img/game-completed.${k.D.SVG}`,this.translationProp="win"}playSound(){return(0,T.Z)(function*(){yield _.d.playWinSound()})()}}return t.\u0275fac=function(){let n;return function(s){return(n||(n=e.n5z(t)))(s||t)}}(),t.\u0275cmp=e.Xpm({type:t,selectors:[["game-completed"]],standalone:!0,features:[e.qOj,e.jDz],decls:2,vars:3,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"w--100",3,"src"],[1,"container__text"]],template:function(o,s){1&o&&(e.YNc(0,J,5,6,"div",0),e.ALo(1,"async")),2&o&&e.Q6J("ngIf",e.lcZ(1,1,s.message$))},dependencies:[c.O5,c.Ov,G.G],styles:[".container[_ngcontent-%COMP%]{display:grid;max-width:400px;width:100%;height:100%;margin:auto;place-items:center}.container__text[_ngcontent-%COMP%]{margin-top:1rem;font-size:3rem;text-align:center}"],changeDetection:0}),t})();function w(t,n){if(1&t&&(e.TgZ(0,"div",1),e._UZ(1,"img",2),e.TgZ(2,"div",3),e._uU(3),e.ALo(4,"capitalizeFirstLetter"),e.qZA()()),2&t){const o=n.ngIf,s=e.oxw();e.xp6(1),e.Q6J("src",s.imgSrc,e.LSH),e.xp6(1),e.Udp("color",s.colors.ORANGE),e.xp6(1),e.hij(" ",e.lcZ(4,4,o)," ")}}let z=(()=>{class t extends y{constructor(){super(...arguments),this.imgSrc=`../../../../../assets/img/game-failed.${k.D.PNG}`,this.translationProp="fail"}playSound(){return(0,T.Z)(function*(){yield _.d.playGameFailedSound()})()}}return t.\u0275fac=function(){let n;return function(s){return(n||(n=e.n5z(t)))(s||t)}}(),t.\u0275cmp=e.Xpm({type:t,selectors:[["game-failed"]],standalone:!0,features:[e.qOj,e.jDz],decls:2,vars:3,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"w--100",3,"src"],[1,"container__text"]],template:function(o,s){1&o&&(e.YNc(0,w,5,6,"div",0),e.ALo(1,"async")),2&o&&e.Q6J("ngIf",e.lcZ(1,1,s.message$))},dependencies:[c.O5,c.Ov,G.G],styles:[".container[_ngcontent-%COMP%]{display:grid;max-width:400px;width:100%;height:100%;margin:auto;place-items:center}.container__text[_ngcontent-%COMP%]{margin-top:1rem;font-size:3rem;text-align:center}"],changeDetection:0}),t})(),R=(()=>{class t{constructor(){this.stepBack=new e.vpe}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["step-back"]],outputs:{stepBack:"stepBack"},standalone:!0,features:[e.jDz],decls:3,vars:0,consts:[[1,"step-back","smooth-bg",3,"click"],[1,"step-back__triangle"],[1,"step-back__stick"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return s.stepBack.emit()}),e._UZ(1,"div",1)(2,"div",2),e.qZA())},styles:[".step-back[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;cursor:pointer}.step-back__stick[_ngcontent-%COMP%]{width:50px;height:12px;position:relative;background-color:#00d36f}.step-back__triangle[_ngcontent-%COMP%]{width:0;height:0;border-style:solid;border-width:20px 25px 20px 0;border-color:transparent #00d36f transparent transparent}"],changeDetection:0}),t})();var l,h,p,r,O,C,$=i(500),D=i(4774);const H=["contentContainer"],j=["content"],U=["header"],L=["closeGame"],E=["menuToggle"];function W(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"step-back",11),e.NdJ("stepBack",function(){e.CHM(o);const m=e.oxw();return e.KtG(m.stepBack())}),e.qZA()}}function K(t,n){1&t&&e.GkF(0)}const b=function(t){return{$implicit:t}};function X(t,n){if(1&t&&(e.TgZ(0,"div",12),e.YNc(1,K,1,0,"ng-container",13),e.qZA()),2&t){const o=e.oxw(),s=e.MAs(9);e.xp6(1),e.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",e.VKq(2,b,o.gameStepsInfo))}}function V(t,n){1&t&&e.GkF(0)}function q(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"menu-toggle",14,15),e.YNc(2,V,1,0,"ng-container",13),e.TgZ(3,"step-back",11),e.NdJ("stepBack",function(){e.CHM(o);const m=e.oxw();return e.KtG(m.stepBack())}),e.qZA()()}if(2&t){const o=e.oxw(),s=e.MAs(9);e.Q6J("appearanceFrom",o.menuAppearanceFrom),e.xp6(2),e.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",e.VKq(3,b,o.gameStepsInfo))}}function ee(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",18),e.NdJ("click",function(){e.CHM(o);const m=e.oxw().index,oe=e.oxw(2);return e.KtG(oe.goToStep(m))}),e._uU(1),e.ALo(2,"capitalizeFirstLetter"),e.qZA()}if(2&t){const o=e.oxw().$implicit;e.Q6J("ngStyle",o.style),e.xp6(1),e.hij(" ",e.lcZ(2,2,o.title)," ")}}function te(t,n){if(1&t&&(e.ynx(0),e.YNc(1,ee,3,4,"div",17),e.BQk()),2&t){const o=n.$implicit;e.xp6(1),e.Q6J("ngIf",o)}}function ne(t,n){1&t&&e.YNc(0,te,2,1,"ng-container",16),2&t&&e.Q6J("ngForOf",n.$implicit)}class u{constructor(n,o,s){this._router=n,this._cdRef=o,this._stepsConfig=s,l.add(this),this.gameStepsInfo=[],this.colors=x.r,this.menuAppearanceFrom="left",h.set(this,void 0),p.set(this,0),r.set(this,new M.x)}ngOnInit(){if(!this._stepsConfig||!this._stepsConfig.length)throw new Error("No steps!!!");v.B.chosenGameId||(v.B.chosenGameId=this._router.routerState.snapshot.url.split("/").pop()),d.A.goToNext$.pipe((0,g.b)(()=>{var n;return this.goToStep((0,a.YH)(this,p,(n=(0,a.Q_)(this,p,"f"),++n),"f"))}),(0,f.R)((0,a.Q_)(this,r,"f"))).subscribe(),d.A.updateStepInfo$.pipe((0,g.b)(n=>{this.gameStepsInfo[(0,a.Q_)(this,p,"f")]=n,this._cdRef.detectChanges()}),(0,f.R)((0,a.Q_)(this,r,"f"))).subscribe(),d.A.gameCompleted$.pipe((0,g.b)(()=>(0,a.Q_)(this,l,"m",C).call(this,N)),(0,f.R)((0,a.Q_)(this,r,"f"))).subscribe(),d.A.gameFailed$.pipe((0,g.b)(()=>(0,a.Q_)(this,l,"m",C).call(this,z)),(0,f.R)((0,a.Q_)(this,r,"f"))).subscribe(),d.A.stepsToReset$.pipe((0,g.b)(n=>(0,a.Q_)(this,l,"m",O).call(this,n)),(0,f.R)((0,a.Q_)(this,r,"f"))).subscribe(),this.goToStep((0,a.Q_)(this,p,"f"))}ngAfterViewInit(){v.B.gameOffsetTop=this.contentContainer.nativeElement.getBoundingClientRect().top}ngOnDestroy(){_.d.stopSound(),(0,a.Q_)(this,r,"f").next(),(0,a.Q_)(this,r,"f").unsubscribe(),(0,a.Q_)(this,h,"f").destroy()}stepBack(){var n;(0,a.Q_)(this,p,"f")>0?(this.gameStepsInfo[(0,a.YH)(this,p,(n=(0,a.Q_)(this,p,"f"),--n),"f")]||this.stepBack(),this.goToStep((0,a.Q_)(this,p,"f"))):this.closeGameComponent.closeGame()}goToStep(n){(0,a.YH)(this,p,n,"f"),(0,a.Q_)(this,l,"m",C).call(this,this._stepsConfig[(0,a.Q_)(this,p,"f")]),this.menuToggle?.closeMenu()}}h=new WeakMap,p=new WeakMap,r=new WeakMap,l=new WeakSet,O=function(n){n.forEach(o=>{null!==this.gameStepsInfo[o]&&(this.gameStepsInfo[o]=null)}),this._cdRef.detectChanges()},C=function(n){_.d.stopSound(),this.content.clear(),(0,a.YH)(this,h,this.content.createComponent(n),"f"),this._cdRef.detectChanges()},u.\u0275fac=function(n){return new(n||u)(e.Y36(D.F0),e.Y36(e.sBO),e.Y36(Q.s))},u.\u0275cmp=e.Xpm({type:u,selectors:[["game-steps"]],viewQuery:function(n,o){if(1&n&&(e.Gf(H,7),e.Gf(j,7,e.s_b),e.Gf(U,7),e.Gf(L,7),e.Gf(E,5)),2&n){let s;e.iGM(s=e.CRH())&&(o.contentContainer=s.first),e.iGM(s=e.CRH())&&(o.content=s.first),e.iGM(s=e.CRH())&&(o.headerEl=s.first),e.iGM(s=e.CRH())&&(o.closeGameComponent=s.first),e.iGM(s=e.CRH())&&(o.menuToggle=s.first)}},standalone:!0,features:[e.jDz],decls:14,vars:3,consts:[[1,"steps"],[1,"header"],["header",""],[3,"stepBack",4,"ifMobile"],["class","game-info",4,"ifMobile"],[3,"appearanceFrom",4,"ifMobile"],[1,"close-game"],["closeGame",""],["gameStepsInfoTmpl",""],["contentContainer",""],["content",""],[3,"stepBack"],[1,"game-info"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"appearanceFrom"],["menuToggle",""],[4,"ngFor","ngForOf"],["class","game-info__step smooth-bg",3,"ngStyle","click",4,"ngIf"],[1,"game-info__step","smooth-bg",3,"ngStyle","click"]],template:function(n,o){1&n&&(e.TgZ(0,"div",0)(1,"div",1,2),e.YNc(3,W,1,0,"step-back",3),e.YNc(4,X,2,4,"div",4),e.YNc(5,q,4,5,"menu-toggle",5),e._UZ(6,"close-game",6,7),e.qZA(),e.YNc(8,ne,1,1,"ng-template",null,8,e.W1O),e.TgZ(10,"div",null,9),e._UZ(12,"template",null,10),e.qZA()()),2&n&&(e.xp6(3),e.Q6J("ifMobile",!1),e.xp6(1),e.Q6J("ifMobile",!1),e.xp6(1),e.Q6J("ifMobile",!0))},dependencies:[c.ez,c.sg,c.O5,c.tP,c.PC,G.G,B,R,F.d,$.u],styles:[".steps[_ngcontent-%COMP%]{display:grid;height:100%;grid-template-rows:min-content 1fr}.header[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto min-content;place-items:center;margin-bottom:1rem;position:sticky;top:.5rem;z-index:1}.game-info[_ngcontent-%COMP%]{display:grid;place-items:center;grid-auto-flow:column;grid-gap:2rem}.game-info__step[_ngcontent-%COMP%]{font-size:2rem;cursor:pointer;text-align:center}.game-info__step[_ngcontent-%COMP%]:hover{text-decoration:underline}@media screen and (max-width: 1024px){.close-game[_ngcontent-%COMP%]{grid-column-start:3}}"],changeDetection:0})}}]);