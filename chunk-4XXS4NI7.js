import{a as we,b as T,c as Me,d as E}from"./chunk-BGTDJZQO.js";import{c as ke}from"./chunk-LWSWHT3V.js";import{a as Y,b as Fe,c as Ge}from"./chunk-SG4JUGDG.js";import{g as W,k as Te}from"./chunk-7YRR4ONJ.js";import{a as B}from"./chunk-SQADIMNP.js";import{$b as x,A as ae,Bb as q,Db as _,H as ce,Ha as Q,Ia as j,La as L,Mc as Ce,Nc as ye,Ob as l,Pa as pe,Pb as U,Pc as re,Sb as H,Sc as ve,Tb as de,Tc as Se,Ub as ge,Uc as K,Vb as fe,Vc as xe,Wb as a,Xb as p,Yb as C,Zb as ie,_b as J,ac as h,bd as X,dd as be,e as s,f,g as S,gc as M,h as R,hc as O,i as te,ic as P,jb as N,jc as ne,k as V,kc as I,mc as D,na as F,nb as c,oa as G,ob as A,oc as ue,q as se,qc as oe,tb as me,tc as b,uc as k,wc as he,xb as u,ya as z,yc as _e,zb as le}from"./chunk-RJ2WF6JB.js";var Oe=(()=>{var e;let i=class i{constructor(){f(this,e,z(re))}closeGame(){s(this,e).back(),ke.unsetTheme()}};e=new WeakMap,i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=u({type:i,selectors:[["close-game"]],features:[ue([re,{provide:Ce,useClass:ye}])],decls:1,vars:0,consts:[[1,"cross","smooth-bg",3,"click"]],template:function(o,y){o&1&&(a(0,"div",0),x("click",function(){return y.closeGame()}),p())},styles:['.cross[_ngcontent-%COMP%]{width:50px;height:50px;position:relative;cursor:pointer}.cross[_ngcontent-%COMP%]:before{content:"";width:100%;height:20%;background-color:#ff2480;position:absolute;top:20px;transform:rotate(45deg)}.cross[_ngcontent-%COMP%]:after{content:"";width:100%;height:20%;background-color:#ff2480;position:absolute;top:20px;transform:rotate(-45deg)}'],changeDetection:0});let t=i;return t})();var Z=(()=>{var e;let i=class i{constructor(){f(this,e);this.message$=null,this.colors=Y,S(this,e,z(be))}ngOnInit(){this.message$=ce({img:Ge.getImage(this.imgSrc),translation:s(this,e).loadTranslation("game_finished")}).pipe(ae(n=>(this.playSound(),n.translation[this.translationProp])))}};e=new WeakMap,i.\u0275fac=function(o){return new(o||i)},i.\u0275dir=le({type:i});let t=i;return t})();function Re(t,e){if(t&1&&(a(0,"div",0),C(1,"img",1),a(2,"div",2),I(3),b(4,"capitalizeFirstLetter"),p()()),t&2){let i=h();c(),l("src",i.imgSrc,N),c(),U("color",i.colors.ORANGE),c(),D(" ",k(4,4,e)," ")}}var Pe=(()=>{let e=class e extends Z{constructor(){super(...arguments),this.imgSrc=`../../../../../assets/img/game-completed.${X.SVG}`,this.translationProp="win"}playSound(){return V(this,null,function*(){yield T.playWinSound()})}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=L(e)))(o||e)}})(),e.\u0275cmp=u({type:e,selectors:[["game-completed"]],features:[q],decls:2,vars:3,consts:[[1,"container"],[1,"w--100",3,"src"],[1,"container__text"]],template:function(n,o){if(n&1&&(_(0,Re,5,6,"div",0),b(1,"async")),n&2){let y;H((y=k(1,1,o.message$))?0:-1,y)}},dependencies:[K,B],styles:[".container[_ngcontent-%COMP%]{display:grid;max-width:400px;width:100%;height:100%;margin:auto;place-items:center}.container__text[_ngcontent-%COMP%]{margin-top:1rem;font-size:3rem;text-align:center}"],changeDetection:0});let t=e;return t})();function $e(t,e){if(t&1&&(a(0,"div",0),C(1,"img",1),a(2,"div",2),I(3),b(4,"capitalizeFirstLetter"),p()()),t&2){let i=h();c(),l("src",i.imgSrc,N),c(),U("color",i.colors.ORANGE),c(),D(" ",k(4,4,e)," ")}}var Ie=(()=>{let e=class e extends Z{constructor(){super(...arguments),this.imgSrc=`../../../../../assets/img/game-failed.${X.PNG}`,this.translationProp="fail"}playSound(){return V(this,null,function*(){yield T.playGameFailedSound()})}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=L(e)))(o||e)}})(),e.\u0275cmp=u({type:e,selectors:[["game-failed"]],features:[q],decls:2,vars:3,consts:[[1,"container"],[1,"w--100",3,"src"],[1,"container__text"]],template:function(n,o){if(n&1&&(_(0,$e,5,6,"div",0),b(1,"async")),n&2){let y;H((y=k(1,1,o.message$))?0:-1,y)}},dependencies:[K,B],styles:[".container[_ngcontent-%COMP%]{display:grid;max-width:400px;width:100%;height:100%;margin:auto;place-items:center}.container__text[_ngcontent-%COMP%]{margin-top:1rem;font-size:3rem;text-align:center}"],changeDetection:0});let t=e;return t})();var De=(()=>{let e=class e{constructor(){this.stepBack=new pe}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=u({type:e,selectors:[["step-back"]],outputs:{stepBack:"stepBack"},decls:3,vars:0,consts:[[1,"step-back","smooth-bg",3,"click"],[1,"step-back__triangle"],[1,"step-back__stick"]],template:function(n,o){n&1&&(a(0,"div",0),x("click",function(){return o.stepBack.emit()}),C(1,"div",1)(2,"div",2),p())},styles:[".step-back[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;cursor:pointer}.step-back__stick[_ngcontent-%COMP%]{width:50px;height:12px;position:relative;background-color:#00d36f}.step-back__triangle[_ngcontent-%COMP%]{width:0;height:0;border-style:solid;border-width:20px 25px 20px 0;border-color:transparent #00d36f transparent transparent}"],changeDetection:0});let t=e;return t})();var Ve=["contentContainer"],ze=["content"],Qe=["header"],je=["closeGame"],Le=["menuToggle"],Be=t=>({$implicit:t});function Ne(t,e){if(t&1){let i=J();a(0,"step-back",12),x("stepBack",function(){Q(i);let n=h();return j(n.stepBack())}),p()}}function Ae(t,e){t&1&&ie(0)}function qe(t,e){if(t&1&&(a(0,"div",13),_(1,Ae,1,0,"ng-container",14),p()),t&2){let i=h(),r=ne(9);c(),l("ngTemplateOutlet",r)("ngTemplateOutletContext",oe(2,Be,i.gameStepsInfo))}}function Ue(t,e){t&1&&ie(0)}function He(t,e){if(t&1){let i=J();a(0,"menu-toggle",15,5),_(2,Ue,1,0,"ng-container",14),a(3,"step-back",12),x("stepBack",function(){Q(i);let n=h();return j(n.stepBack())}),p()()}if(t&2){let i=h(),r=ne(9);l("appearanceFrom",i.menuAppearanceFrom),c(2),l("ngTemplateOutlet",r)("ngTemplateOutletContext",oe(3,Be,i.gameStepsInfo))}}function Je(t,e){if(t&1){let i=J();a(0,"div",17),x("click",function(){let n=Q(i).$index,o=h(2);return j(o.goToStep(n))}),I(1),b(2,"capitalizeFirstLetter"),p()}if(t&2){let i=e.$implicit;l("ngStyle",i.style),c(),D(" ",k(2,2,i.title)," ")}}function Ke(t,e){if(t&1&&ge(0,Je,3,4,"div",16,de),t&2){let i=e.$implicit;fe(i)}}var Zt=(()=>{var e,i,r,n,o,Ee,ee;let w=class w{constructor(m,d,v){f(this,o);f(this,e);f(this,i);f(this,r);f(this,n);this._router=m,this._cdRef=d,this._stepsConfig=v,this.colors=Y,this.menuAppearanceFrom="left",S(this,i,0),S(this,r,[]),S(this,n,new se)}get gameStepsInfo(){return s(this,r).filter(Boolean)}ngOnInit(){if(!(this._stepsConfig&&this._stepsConfig.length))throw new Error("No steps!!!");W.chosenGameId||(W.chosenGameId=this._router.routerState.snapshot.url.split("/").pop()),E.goToNext$.pipe(G(()=>this.goToStep(++te(this,i)._)),F(s(this,n))).subscribe(),E.updateStepInfo$.pipe(G(m=>{s(this,r)[s(this,i)]=m,this._cdRef.detectChanges()}),F(s(this,n))).subscribe(),E.gameCompleted$.pipe(G(()=>R(this,o,ee).call(this,Pe)),F(s(this,n))).subscribe(),E.gameFailed$.pipe(G(()=>R(this,o,ee).call(this,Ie)),F(s(this,n))).subscribe(),E.stepsToReset$.pipe(G(m=>R(this,o,Ee).call(this,m)),F(s(this,n))).subscribe(),this.goToStep(s(this,i))}ngAfterViewInit(){W.gameOffsetTop=this.contentContainer.nativeElement.getBoundingClientRect().top}ngOnDestroy(){T.stopSound(),s(this,n).next(),s(this,n).unsubscribe(),s(this,e).destroy()}stepBack(){s(this,i)>0?(s(this,r)[--te(this,i)._]||this.stepBack(),this.goToStep(s(this,i))):this.closeGameComponent.closeGame()}goToStep(m){S(this,i,m),R(this,o,ee).call(this,this._stepsConfig[s(this,i)]),this.menuToggle?.closeMenu()}};e=new WeakMap,i=new WeakMap,r=new WeakMap,n=new WeakMap,o=new WeakSet,Ee=function(m){m.forEach(d=>s(this,r).splice(d,1)),this._cdRef.detectChanges()},ee=function(m){T.stopSound(),this.content.clear(),S(this,e,this.content.createComponent(m)),this._cdRef.detectChanges()},w.\u0275fac=function(d){return new(d||w)(A(Te),A(_e),A(Me))},w.\u0275cmp=u({type:w,selectors:[["game-steps"]],viewQuery:function(d,v){if(d&1&&(M(Ve,7),M(ze,7,me),M(Qe,7),M(je,7),M(Le,5)),d&2){let g;O(g=P())&&(v.contentContainer=g.first),O(g=P())&&(v.content=g.first),O(g=P())&&(v.headerEl=g.first),O(g=P())&&(v.closeGameComponent=g.first),O(g=P())&&(v.menuToggle=g.first)}},decls:14,vars:3,consts:[["header",""],["closeGame",""],["gameStepsInfoTmpl",""],["contentContainer",""],["content",""],["menuToggle",""],[1,"steps"],[1,"header"],[3,"stepBack",4,"ifMobile"],["class","game-info",4,"ifMobile"],[3,"appearanceFrom",4,"ifMobile"],[1,"close-game"],[3,"stepBack"],[1,"game-info"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"appearanceFrom"],[1,"game-info__step","smooth-bg",3,"ngStyle"],[1,"game-info__step","smooth-bg",3,"click","ngStyle"]],template:function(d,v){d&1&&(a(0,"div",6)(1,"div",7,0),_(3,Ne,1,0,"step-back",8)(4,qe,2,4,"div",9)(5,He,4,5,"menu-toggle",10),C(6,"close-game",11,1),p(),_(8,Ke,2,0,"ng-template",null,2,he),a(10,"div",null,3),C(12,"template",null,4),p()()),d&2&&(c(3),l("ifMobile",!1),c(),l("ifMobile",!1),c(),l("ifMobile",!0))},dependencies:[xe,Se,ve,B,Oe,De,we,Fe],styles:[".steps[_ngcontent-%COMP%]{display:grid;height:100%;grid-template-rows:min-content 1fr}.header[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto min-content;place-items:center;margin-bottom:1rem;position:sticky;top:.5rem;z-index:1}.game-info[_ngcontent-%COMP%]{display:grid;place-items:center;grid-auto-flow:column;grid-gap:2rem}.game-info__step[_ngcontent-%COMP%]{font-size:2rem;cursor:pointer;text-align:center}.game-info__step[_ngcontent-%COMP%]:hover{text-decoration:underline}@media screen and (max-width: 1024px){.close-game[_ngcontent-%COMP%]{grid-column-start:3}}"],changeDetection:0});let t=w;return t})();export{Zt as GameStepsComponent};
